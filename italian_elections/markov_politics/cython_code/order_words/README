Here I am extending the previous code to be able to handle with  
Markov chains of order n
